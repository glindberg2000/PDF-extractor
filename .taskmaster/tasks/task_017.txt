# Task ID: 17
# Title: Extract Optional Statement Metadata
# Status: done
# Dependencies: 14
# Priority: medium
# Description: Implement functionality to extract optional metadata such as account number and statement end date from the PDF.
# Details:
Create a method to extract optional metadata from the statement, including account number and statement end date. These fields may be present in different locations in the PDF, so use pattern matching to find them. Add the extracted metadata to each transaction record.

```python
def extract_statement_metadata(self, text_content):
    """Extract statement metadata like account number and statement end date"""
    metadata = {}
    
    # Extract account number
    account_patterns = [
        r'Account\s+Number\s*[:#]?\s*(\d+[\d\*]+\d+)',
        r'Account\s*[:#]?\s*(\d+[\d\*]+\d+)',
        r'Card\s+Number\s*[:#]?\s*(\d+[\d\*]+\d+)'
    ]
    
    for pattern in account_patterns:
        match = re.search(pattern, text_content, re.IGNORECASE)
        if match:
            metadata['account_number'] = match.group(1).strip()
            break
    
    # Extract statement end date
    date_patterns = [
        r'Statement\s+(?:End|Closing)\s+Date\s*[:#]?\s*(\d{1,2}/\d{1,2}/\d{2,4})',
        r'Statement\s+Date\s*[:#]?\s*(\d{1,2}/\d{1,2}/\d{2,4})',
        r'Closing\s+Date\s*[:#]?\s*(\d{1,2}/\d{1,2}/\d{2,4})'
    ]
    
    for pattern in date_patterns:
        match = re.search(pattern, text_content, re.IGNORECASE)
        if match:
            metadata['statement_end_date'] = match.group(1).strip()
            break
    
    return metadata

# Update extract_transactions method to include metadata
def extract_transactions(self, text_content, file_path):
    # Get existing code from Task 16
    # ...
    
    # Extract metadata
    metadata = self.extract_statement_metadata(text_content)
    
    # Add metadata to each transaction
    for transaction in transactions:
        transaction.update({k: v for k, v in metadata.items() if v})
    
    return transactions
```

# Test Strategy:
Test with statements containing various metadata formats. Verify that account numbers and statement end dates are correctly extracted when present. Check that metadata is properly added to each transaction record.
